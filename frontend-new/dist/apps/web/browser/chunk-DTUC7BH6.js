import{b as U,i as d,m as F,o as D,t as G}from"./chunk-VSR5JVYN.js";import{H as y,N as l,Q as A,R as g,S as c,_ as k,da as w,f as b,g as N,h as P,j as s,l as h,oa as E,p as T,x as m}from"./chunk-WWCH6M6L.js";var p=(function(t){return t.Redirect="redirect",t.Popup="popup",t.Silent="silent",t.None="none",t})(p||{}),n={Startup:"startup",Login:"login",Logout:"logout",AcquireToken:"acquireToken",SsoSilent:"ssoSilent",HandleRedirect:"handleRedirect",None:"none"};var C={React:"@azure/msal-react",Angular:"@azure/msal-angular"},x="msal.db";var J=`${x}.keys`,I={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},W=[I.Default,I.Skip,I.RefreshTokenAndNetwork];var a={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache",BROKER_CONNECTION_ESTABLISHED:"msal:brokerConnectionEstablished"};var S=class{static getInteractionStatusFromEvent(r,e){switch(r.eventType){case a.LOGIN_START:return n.Login;case a.SSO_SILENT_START:return n.SsoSilent;case a.ACQUIRE_TOKEN_START:if(r.interactionType===p.Redirect||r.interactionType===p.Popup)return n.AcquireToken;break;case a.HANDLE_REDIRECT_START:return n.HandleRedirect;case a.LOGOUT_START:return n.Logout;case a.SSO_SILENT_SUCCESS:case a.SSO_SILENT_FAILURE:if(e&&e!==n.SsoSilent)break;return n.None;case a.LOGOUT_END:if(e&&e!==n.Logout)break;return n.None;case a.HANDLE_REDIRECT_END:if(e&&e!==n.HandleRedirect)break;return n.None;case a.LOGIN_SUCCESS:case a.LOGIN_FAILURE:case a.ACQUIRE_TOKEN_SUCCESS:case a.ACQUIRE_TOKEN_FAILURE:case a.RESTORE_FROM_BFCACHE:if(r.interactionType===p.Redirect||r.interactionType===p.Popup){if(e&&e!==n.Login&&e!==n.AcquireToken)break;return n.None}break}return null}};var R="@azure/msal-angular",v="4.0.26",j=new A("MSAL_INSTANCE");var q=new A("MSAL_BROADCAST_CONFIG"),H=(()=>{class t{constructor(e,o){this.msalInstance=e,this.msalBroadcastConfig=o,this.msalBroadcastConfig&&this.msalBroadcastConfig.eventsToReplay>0?(this.msalInstance.getLogger().clone(R,v).verbose(`BroadcastService - eventsToReplay set on BroadcastConfig, replaying the last ${this.msalBroadcastConfig.eventsToReplay} events`),this._msalSubject=new P(this.msalBroadcastConfig.eventsToReplay)):this._msalSubject=new b,this.msalSubject$=this._msalSubject.asObservable(),this._inProgress=new N(n.Startup),this.inProgress$=this._inProgress.asObservable(),this.msalInstance.addEventCallback(i=>{this._msalSubject.next(i);let u=S.getInteractionStatusFromEvent(i,this._inProgress.value);u!==null&&(this.msalInstance.getLogger().clone(R,v).verbose(`BroadcastService - ${i.eventType} results in setting inProgress from ${this._inProgress.value} to ${u}`),this._inProgress.next(u))})}resetInProgressEvent(){this._inProgress.value===n.Startup&&this._inProgress.next(n.None)}}return t.\u0275fac=function(e){return new(e||t)(g(j),g(q,8))},t.\u0275prov=l({token:t,factory:t.\u0275fac}),t})(),B=(()=>{class t{constructor(e,o,i){this.instance=e,this.location=o,this.injector=i;let u=this.location.path(!0).split("#").pop();u&&(this.redirectHash=`#${u}`),this.instance.initializeWrapperLibrary(C.Angular,v)}initialize(){return s(this.instance.initialize())}acquireTokenPopup(e){return s(this.instance.acquireTokenPopup(e))}acquireTokenRedirect(e){return s(this.instance.acquireTokenRedirect(e))}acquireTokenSilent(e){return s(this.instance.acquireTokenSilent(e))}handleRedirectObservable(e){return s(this.instance.initialize().then(()=>this.instance.handleRedirectPromise(e||this.redirectHash)).finally(()=>{this.injector.get(H).resetInProgressEvent()}))}loginPopup(e){return s(this.instance.loginPopup(e))}loginRedirect(e){return s(this.instance.loginRedirect(e))}logout(e){return s(this.instance.logout(e))}logoutRedirect(e){return s(this.instance.logoutRedirect(e))}logoutPopup(e){return s(this.instance.logoutPopup(e))}ssoSilent(e){return s(this.instance.ssoSilent(e))}getLogger(){return this.logger||(this.logger=this.instance.getLogger().clone(R,v)),this.logger}setLogger(e){this.logger=e.clone(R,v),this.instance.setLogger(e)}}return t.\u0275fac=function(e){return new(e||t)(g(j),g(U),g(k))},t.\u0275prov=l({token:t,factory:t.\u0275fac}),t})();var L=(()=>{let r=class r{constructor(){this.msalService=c(B),this.platformId=c(E)}acquireToken(o){if(!d(this.platformId))return h(()=>new Error("MSAL not available on server"));let i=this.msalService.instance.getActiveAccount();return i?s(this.msalService.instance.acquireTokenSilent({scopes:o,account:i})).pipe(T(u=>u.accessToken),m(u=>h(()=>u))):h(()=>new Error("No active MSAL account"))}logout(){return d(this.platformId)?s(this.msalService.instance.logoutRedirect()).pipe(m(o=>h(()=>o))):h(()=>new Error("MSAL not available on server"))}};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"});let t=r;return t})();var M="internal_jwt",O=(()=>{let r=class r{constructor(){this.platformId=c(E)}store(o){d(this.platformId)&&localStorage.setItem(M,JSON.stringify(o))}retrieve(){if(!d(this.platformId))return null;let o=localStorage.getItem(M);if(!o)return null;try{return JSON.parse(o)}catch{return null}}clear(){d(this.platformId)&&localStorage.removeItem(M)}};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"});let t=r;return t})();var K="api-endpoint/account/authenticate",$=["User.Read"],f=(()=>{let r=class r{constructor(){this.http=c(D),this.msalFacade=c(L),this.jwtStorage=c(O),this.session=w(null)}initialize(){let o=this.jwtStorage.retrieve();o&&this.session.set(o)}authenticate(){return this.msalFacade.acquireToken($).pipe(y(o=>{let i=new F({Authorization:`Bearer ${o}`});return this.http.post(K,{},{headers:i})}),T(o=>{let i={internalJwt:o.token,expiresAt:o.expiresAt};return this.jwtStorage.store(i),this.session.set(i),i}),m(o=>h(()=>o)))}logout(){return this.jwtStorage.clear(),this.session.set(null),this.msalFacade.logout()}};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"});let t=r;return t})();var We=300*1e3;var z="api-endpoint/account/authenticate",Q=(t,r)=>{let e=c(f);if(t.url.includes(z))return r(t);let o=e.session();if(!o?.internalJwt)return r(t);let i=t.clone({setHeaders:{Authorization:`Bearer ${o.internalJwt}`}});return r(i)};var V=()=>{let t=c(f),r=c(G);return t.session()?.internalJwt?!0:r.createUrlTree(["/login"])};export{f as a,Q as b,V as c};
