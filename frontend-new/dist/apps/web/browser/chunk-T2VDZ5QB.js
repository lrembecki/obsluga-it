import{a as L}from"./chunk-PNV6W4UV.js";import{b as A}from"./chunk-RAPXP5WM.js";import{n as F,o as H}from"./chunk-VSR5JVYN.js";import{$a as u,Bb as v,Gb as D,Hb as j,Ja as l,N as a,S as i,Va as I,Wa as S,X as C,Y as N,Yb as O,Za as m,Zb as M,_a as c,hb as b,jb as p,l as _,lb as f,p as U,ua as y,x as w,zb as g}from"./chunk-WWCH6M6L.js";function R(e){if(!(e instanceof F))return{code:"UNKNOWN_ERROR",message:e instanceof Error?e.message:"An unknown error occurred"};if(e.status===0)return{code:"NETWORK_ERROR",message:"Network connection failed"};let t=k(e.status),o=W(e);return{code:t,message:o,details:z(e.error)}}function k(e){switch(e){case 401:return"UNAUTHORIZED";case 403:return"FORBIDDEN";case 404:return"NOT_FOUND";case 422:return"VALIDATION_ERROR";default:return e>=500?"SERVER_ERROR":"UNKNOWN_ERROR"}}function W(e){if(typeof e.error=="object"&&e.error!==null){let t=e.error;if(typeof t.message=="string")return t.message}return e.message}function z(e){if(e!=null&&typeof e!="string"&&typeof e=="object"){let{message:t,errors:o}=e;return{message:t,errors:o}}}function G(e){return e==="ADMIN"||e==="USER"||e==="VIEWER"?e:"VIEWER"}function h(e){return{id:e.id,email:e.email,displayName:e.display_name,role:G(e.role),isActive:e.is_active}}var P=(()=>{let t=class t{constructor(){this.http=i(H)}getUsers(){return this.http.get("/api/users")}};t.\u0275fac=function(s){return new(s||t)},t.\u0275prov=a({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var E=(()=>{let t=class t{constructor(){this.api=i(P)}getUsers(){return this.api.getUsers().pipe(U(r=>({items:r.items.map(h),total:r.total})),w(r=>_(()=>R(r))))}};t.\u0275fac=function(s){return new(s||t)},t.\u0275prov=a({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var T=(()=>{let t=class t{constructor(){this.usersGateway=i(E),this.usersResource=A({stream:()=>this.usersGateway.getUsers()})}get isLoading(){return this.usersResource.isLoading}get users(){return this.usersResource.value}get error(){let r=this.usersResource.error();return r||null}reload(){this.usersResource.reload()}};t.\u0275fac=function(s){return new(s||t)},t.\u0275prov=a({token:t,factory:t.\u0275fac});let e=t;return e})();var x=(()=>{let t=class t{constructor(){this.users=M.required(),this.userSelected=O(),this.columns=[{field:"displayName",header:"Name"},{field:"email",header:"Email"},{field:"role",header:"Role"}]}usersAsRows(){return this.users()}onRowSelected(r){this.userSelected.emit(r)}};t.\u0275fac=function(s){return new(s||t)},t.\u0275cmp=l({type:t,selectors:[["users-table"]],inputs:{users:[1,"users"]},outputs:{userSelected:"userSelected"},decls:1,vars:2,consts:[[3,"rowSelected","rows","columns"]],template:function(s,n){s&1&&(c(0,"ui-table",0),p("rowSelected",function(V){return n.onRowSelected(V)}),u()),s&2&&m("rows",n.usersAsRows())("columns",n.columns)},dependencies:[L],encapsulation:2});let e=t;return e})();var K=()=>[];function q(e,t){e&1&&(c(0,"p"),g(1,"Loading..."),u())}function B(e,t){if(e&1&&(c(0,"p"),g(1),u()),e&2){let o=f();y(),v("Error: ",o.store.error.message)}}function Z(e,t){if(e&1){let o=b();c(0,"users-table",1),p("userSelected",function(s){C(o);let n=f();return N(n.onUserSelected(s))}),u()}if(e&2){let o,r=f();m("users",((o=r.store.users())==null?null:o.items)??j(1,K))}}var Me=(()=>{let t=class t{constructor(){this.store=i(T)}onUserSelected(r){}};t.\u0275fac=function(s){return new(s||t)},t.\u0275cmp=l({type:t,selectors:[["feature-users-page"]],features:[D([T])],decls:3,vars:1,consts:[[3,"users"],[3,"userSelected","users"]],template:function(s,n){s&1&&I(0,q,2,0,"p")(1,B,2,1,"p")(2,Z,1,2,"users-table",0),s&2&&S(n.store.isLoading()?0:n.store.error?1:2)},dependencies:[x],encapsulation:2});let e=t;return e})();export{T as a,Me as b};
